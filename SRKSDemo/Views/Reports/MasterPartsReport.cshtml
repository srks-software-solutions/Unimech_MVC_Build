@model SRKSDemo.ServerModel.tblpart
@{
    ViewBag.Title = "Index";


}


<div class="right_col" role="main">
    <div class="">

        <div class="clearfix"></div>
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Shift Planner Details</h2>

                        <ul class="nav navbar-right panel_toolbox">
                          
                            <li>
                                <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                            </li>
                        </ul>
                        @*<span style="color:red;"> @TempData["Error"]</span>*@
                        <div class="clearfix"></div>
                    </div>
                   
                        <div id="Error">
                         
                        </div>
                        @using (Html.BeginForm("Create", "ShiftPlanner", FormMethod.Post, new { @class = "form-horizontal bordered-row" }))
                        {
                                                        <!-- create Modal Start -->
                                                <div class="x_content">
                                                    <form class="form-horizontal form-label-left" novalidate>
                                                        <div class="row">
                                                            <div class="col-sm-6">
                                                              
                               
                                                                <div class="row row-space">
                                                                    <label class="col-sm-5 control-label">Plant</label>
                                                                    <div class="col-sm-7">
                                                                        @Html.DropDownListFor(model => model.p, ViewBag.Plant as IEnumerable<SelectListItem>, "--Select Plant--", new { @id = "PlantID", @class = "form-control ", @name = "PlantID", @required = "required" })

                                                                    </div>
                                                                </div>
                                                                <div class="row row-space">
                                                                    <label class="col-sm-5 control-label">Shop</label>
                                                                    <div class="col-sm-7">
                                                                        @Html.DropDownListFor(model => model.ShopID, ViewBag.ShopID as IEnumerable<SelectListItem>, "--Select Shop--", new { @id = "ShopID", @class = "form-control ", @name = "ShopID", @required = "required" })

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-6">
                                                                <div class="row row-space">
                                                                    <label class="col-sm-5 control-label">CELl</label>
                                                                    <div class="col-sm-7">
                                                                        @Html.DropDownListFor(model => model, ViewBag.CellID as IEnumerable<SelectListItem>, "--Select CELL--", new { @id = "MachineCategoryID", @class = "form-control", @name = "CellID", @required = "required" })

                                                                    </div>
                                                                </div>
                                                                <div class="row row-space">
                                                                    <label class="col-sm-5 control-label">Machine</label>
                                                                    <div class="col-sm-7">
                                                                        @Html.DropDownListFor(model => model.ShiftPlanner.MachineID, ViewBag.MachineID as IEnumerable<SelectListItem>, "--Select Machine--", new { @id = "MachineID", @class = "form-control ", @name = "MachineID", @required = "required" })

                                                                    </div>
                                                                </div>
                                                                <div class="row row-space">
                                                                    <label class="col-sm-5 control-label">Start Date</label>
                                                                    <div class="col-sm-7">
                                                                        <div class='form input-group date' id='myDatepicker2'>
                                                                            @*<input type='text' class="form-control" />*@
                                                                            @Html.TextBoxFor(model => model.ShiftPlanner.StartDate, new { @id = "SPStartDate", @name = "SPStartDate", @class = "form-control second", @placeholder = "Enter SPStartDate", @required = "required", @Value = DateTime.Now.Date })
                                                                            <span class="input-group-addon">
                                                                                <span class="glyphicon glyphicon-calendar"></span>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row row-space">
                                                                    <label class="col-sm-5 control-label">End Date</label>
                                                                    <div class="col-sm-7">
                                                                        <div class='input-group date' id='myDatepicker1'>
                                                                            @*<input type='text' class="form-control" />*@
                                                                            @Html.TextBoxFor(model => model.EndDate, new { @id = "SPEndDate", @name = "SPEndDate", @class = "form-control second", @placeholder = "Enter SPEndDate", @required = "required", @Value = DateTime.Now.Date })
                                                                            <span class="input-group-addon">
                                                                                <span class="glyphicon glyphicon-calendar"></span>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>


                                        <div class="modal-footer">
                                            <input type="hidden" id="shiftOverrideConfirm" name="shiftOverrideConfirm" value="0" />
                                            <button type="button" class="btn btn-info createSubmit"><i class="fa fa-floppy-o" aria-hidden="true">Save</i></button>
                                            <button type="submit" class="createSubmitMain" style="display:none"></button>
                                            <button type="button" class="btn btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                                        </div>



                            <button type="button" class="btn btn-info btn-lg mybtn" data-toggle="modal" data-target="#myModal" style="display:none"></button>
                        <li class="actionbtn"><button class="btn btn-round btn-info Planner1" style="display:none" data-title="Edit" data-toggle="modal" data-target="#edit-plant"><i class="fa fa-pencil fa-lg" aria-hidden="true" data-placement="top" data-toggle="tooltip" title="Edit Shift Planner detail"></i></button></li>
                        }
</div>
                    
@*<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">*@


<!-- jQuery -->
@*
    <script src="~/vendors/jquery/dist/jquery.min.js"></script>*@
<script src="~/js/jquery-2.1.4.min.js"></script>
<!-- FastClick -->
<script src="~/vendors/fastclick/lib/fastclick.js"></script>
<script src="~/js/bootstrap.min.js"></script>
<!-- validator -->
<script src="~/vendors/validator/validator.js"></script>

<script src="~/vendors/chosen-select.js" type="text/javascript"></script>
<!-- bootstrap-daterangepicker -->
<script src="~/vendors/moment/min/moment.min.js"></script>
<script src="~/vendors/bootstrap-daterangepicker/daterangepicker.js"></script>
<!-- bootstrap-datetimepicker -->
<script src="~/vendors/bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>


<!-- Datatables -->
<script type="text/javascript">
    $(function () {
        $('.chosen-select').chosen();
    });
</script>
<script>

    $('#myDatepicker2').datetimepicker({
        format: 'YYYY/MM/DD'
    });
</script>
<script>

    $('#myDatepicker1').datetimepicker({
        format: 'YYYY/MM/DD'
    });
</script>
<script>

    $('#myDatepicker3').datetimepicker({
        format: 'YYYY/MM/DD'
    });
</script>
<script>

    $('#myDatepicker4').datetimepicker({
        format: 'YYYY/MM/DD'
    });
</script>
<!-- Bootstrap Timepicker -->
<!--<link rel="stylesheet" type="text/css" href="~/~/assets/widgets/timepicker/timepicker.css">-->
<script type="text/javascript" src="~/vendors/timepicker/timepicker.js"></script>

<script type="text/javascript">
    /* Timepicker */

    $(function () {
        "use strict";
        $('.timepicker-example').timepicker();
    });

    $(document).ready(function () {
        $("[data-toggle=tooltip]").tooltip();
    });


    $(document).ready(function () {
        $('#datatable-responsive').DataTable();
    });
</script>

<script>
    $(function () {
        $("#dialog").dialog();
    });
</script>
<script>

    //Cascading
    $("#PlantID").on("change", function () {
        $("#ShopID").empty();
        $("#CellID").empty();
        $("#MachineID").empty();
        var selectedID = $("#PlantID option:selected").val();
        $.getJSON("/ShiftPlanner/GetShop", { PlantID: selectedID }, function (data) {
            $.each(data, function (index, item) {
                $("#ShopID").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                //$("#CellID").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
            });
            $("#ShopID").prepend("<option value='' selected='selected'></option>");
            $("#MachineID").prepend("<option value='' selected='selected'></option>");
        });
    });

    $("#ShopID").on("change", function () {
        $("#MachineCategoryID").empty();
        $("#MachineID").empty();
        var selectedID = $("#ShopID option:selected").val();
        $.getJSON("/ShiftPlanner/GetCell", { ShopID: selectedID }, function (data) {
            $.each(data, function (index, item) {
                $("#MachineCategoryID").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
            });
            $("#MachineCategoryID").prepend("<option value='' selected='selected'></option>");
        });



    });

    $("#MachineCategoryID").on("change", function () {
        $("#MachineID").empty();
        var selectedID = $("#MachineCategoryID option:selected").val();
        alert(selectedID);
        $.getJSON("/ShiftPlanner/GetWC_Cell", { CellID: selectedID }, function (data) {
            $.each(data, function (index, item) {
                $("#MachineID").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
            });
            $("#MachineID").prepend("<option value='' selected='selected'></option>");

        });
    });
</script>


<script>
    $(".EditShiftPlanner").on("click", function (e) {
        $(".Planner1").click();
        e.preventDefault();
        var ShiftPId = $(this).attr("id")
        $.getJSON("/ShiftPlanner/GetShiftPlannerById", { Id: ShiftPId }, function (Data) {
            $("#EditMSPID").val(ShiftPId);
            $("#EditShiftPlannerName").val((Data.SPlannerName));
            $("#EditShiftPlannerDesc").val((Data.SPlannerDesc));
            $("#EditShiftMethod").val((Data.Sethod));
            $("#EditPlantID").val((Data.plantid));

            $("#EditStartDate").val((Data.startdate));
            $("#EditEndDate").val((Data.enddate));
            var PlantID = Data.plantid;
            $.ajaxSetup({async:false});
            $.getJSON("/ShiftPlanner/GetShop", { PlantID: PlantID }, function (data) {
                $("#EditShopID").empty();
                $("#EditShopID").append("<option value = ''> --Select Shop-- </option>")
                $.each(data, function (index, item) {
                    $("#EditShopID").append("<option value = '" + item.Value + "'>" + item.Text + "</option>")
                });

            });
            $.ajaxSetup({ async: true });
            $("#EditShopID").val(Data.department);

            var ShopID = Data.department;
            $.ajaxSetup({ async: false });
            $.getJSON("/ShiftPlanner/GetCell", { ShopID: ShopID }, function (data) {
                $("#EditMachineCategory").empty();
                $("#EditMachineCategory").append("<option value = ''> --Select Shop-- </option>")
                $.each(data, function (index, item) {
                    $("#EditMachineCategory").append("<option value = '" + item.Value + "'>" + item.Text + "</option>")
                });

            });
            $.ajaxSetup({ async: true });
            $("#EditMachineCategory").val(Data.machinecate);

            var CellID = Data.machinecate;
            alert(CellID)
            $.ajaxSetup({ async: false });
            $.getJSON("/ShiftPlanner/GetWC_Cell", { CellID: CellID }, function (data) {
                $("#EditMachineID").empty();
                $("#EditMachineID").append("<option value = ''> --Select Shop-- </option>")
                $.each(data, function (index, item) {
                    $("#EditMachineID").append("<option value = '" + item.Value + "'>" + item.Text + "</option>")
                });

            });
            $.ajaxSetup({ async: true });
            $("#EditMachineID").val(Data.machineid);
        })

        return false;
    })

</script>

<script>

    function deleteTargetName(productvariant) {
        $(".deleteTargetName").empty();
        $(".deleteTargetName").html("Role Name: " +
            productvariant);
    }

    var item_to_delete;
    $(".deleteItem").click(function (e) {
        item_to_delete = $(this).data('id');
        alert(item_to_delete);
    });
    $('.btnContinueDelete').click(function () {
        window.location = "/ShiftPlanner/Delete/" + "?id=" + item_to_delete;
    });

</script>
@*//This model window is from https://jqueryui.com/dialog/#modal-confirmation*@

<script type="text/javascript">
     $(document).ready(function () {
         $("#OpenDialog").click(function () {
             $("#dialog-confirm").dialog({ modal: true, height: 590, width: 1005 });
         });
     });
</script>
<script type="text/javascript">

     $(".confirmmodalbtn").on("click", function (e) {
             shiftOverrideConfirm
         $("#shiftOverrideConfirm").val(1);
            $(".createSubmitMain").click();
         });

</script>

<script>
    $(".createSubmit").on("click", function (e) {
        e.preventDefault();
        var plannername = $("#ShiftPlannerName").val();
        var PlantId = $("#PlantID").val();
        var ShopId = $("#ShopID").val();
        var CellID = $("#MachineCategoryID").val();
        var MachineID = $("#MachineID").val();
        var SPStartDate = $("#SPStartDate").val();
        var SPEndDate = $("#SPEndDate").val();
        if (plannername != "" && PlantId != "" && ShopId != "" && CellID != "" && MachineID != "" && SPStartDate != "" && SPEndDate != "")
        {
            $.getJSON("/ShiftPlanner/PlanOverLapChecking", { PlantID: PlantId, ShopID: ShopId, CellID: CellID, WorkCenterID: MachineID, startdatestring: SPStartDate, enddatestring: SPEndDate },
                function (data) {
                    if (data == "No") {
                        $(".createSubmitMain").click();
                    }
                    else {
                        $(".mybtn").click();
                    }
                });
        }
        else
        {
            alert("Please fill all the details before submission")
        }
        return false;
    });
</script>

<script type="text/javascript">
    $(".Editconfirmmodalbtn").on("click", function (e) {

        $("#EditshiftOverrideConfirm").val(1);
       // alert($("#shiftOverrideConfirm").val())
        $("#submitsrks").click();
    });
</script>

@*ShiftPlanner edit Confirmation*@
<script>
    $("#submitsrkschild").on("click", function (e) {
        e.preventDefault();
        var plannername = $("#EditShiftPlannerName").val();
        alert(plannername)
        var PlantId = $("#EditPlantID").val();
        var ShopId = $("#EditShopID").val();
        var CellID = $("#EditMachineCategory").val();
        var MachineID = $("#EditMachineID").val();
        var SPStartDate = $("#EditStartDate").val();
        var SPEndDate = $("#EditEndDate").val();

        $.getJSON("/ShiftPlanner/PlanOverLapChecking", { PlantID: PlantId, ShopID: ShopId, CellID: CellID, WorkCenterID: MachineID, startdatestring: SPStartDate, enddatestring: SPEndDate }, function (data) {
            if (data == "No") {
                alert("Inside if")
                $("#submitsrks").click();
            }
            else {
                alert("Else I am in Jquery")
                $(".Editmybtn").click();
            }
        });
        return false;
    });
</script>

<!--Delete-->